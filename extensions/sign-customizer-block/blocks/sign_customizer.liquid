{% schema %}
{
  "name": "Sign Customizer",
  "target": "section",
  "settings": [
    {
      "type": "text",
      "id": "customizer_id",
      "label": "Sign Customizer ID",
      "info": "Enter the ID of the sign customizer to display from your app. Find this in the Customizers page of the app."
    }
  ]
}
{% endschema %}

{% if block.settings.customizer_id != blank %}
  <div
    class="sign-customizer-fullscreen"
    data-customizer-id="{{ block.settings.customizer_id }}"
    id="sign-customizer-{{ block.settings.customizer_id }}"
  >
    <div class="sign-customizer-content">
      <p>Loading customizer...</p>
    </div>
  </div>

  <script>
    (function() {
      const customizerId = '{{ block.settings.customizer_id }}';
      const appUrl = 'https://vertex-backing-spas-clearing.trycloudflare.com/';

      if (!document.querySelector('script[data-sign-customizer-loaded]')) {
        const script = document.createElement('script');
        script.src = appUrl + '/embed/{{ shop.permanent_domain }}';
        script.setAttribute('data-sign-customizer-loaded', 'true');
        script.setAttribute('data-customizer-id', customizerId);
        script.defer = true;
        document.body.appendChild(script);
      }
    })();
  </script>

  <style>
    .sign-customizer-fullscreen {
      width: 100%;
      min-height: 100vh;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #ffffff;
      position: relative;
      overflow: auto;
    }

    .sign-customizer-content {
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
      padding: 2rem;
      box-sizing: border-box;
    }

    .sign-customizer-fullscreen p {
      text-align: center;
      font-size: 18px;
      color: #666;
    }

    @media (max-width: 768px) {
      .sign-customizer-content {
        padding: 1rem;
      }
    }
  </style>
{% else %}
  <div class="sign-customizer-placeholder" style="padding: 20px; background: #f5f5f5; border: 2px dashed #ccc; text-align: center;">
    <p style="margin: 0; color: #666;">
      Please configure the Sign Customizer ID in the theme editor settings.
    </p>
  </div>
{% endif %}
